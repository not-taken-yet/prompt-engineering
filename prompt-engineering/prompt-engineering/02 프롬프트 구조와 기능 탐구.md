# 프롬프트 기초

- **프롬프트**: 새로운 대화 도구
- **프롬프트 엔지니어링**: 자연어로 컴퓨터와 <u>상호작용</u>하는 방법

```
프롬프트란?

- 기원: 나타내다, 생산하다
- 현재: 행동의 신호나 징후, 무언가를 빠르게 또는 지체없이 하는 것
```

## Prompt

> AI 모델에게 응답을 생성하도록 입력하는 텍스트, 문장

## Prompt Engineering

### 정의

> AI 모델로부터 원하는 출력을 얻기 위해 프롬프트를 설계하고 개선하는 과정

인문학(프롬프트) + 기술(엔지니어링)

### 목적

GPT-3와 같은 모델을 미세 조정하여 출력 스타일, 톤, 콘텐츠를 제어함으로써 정확하고 관련성 있는 결과 생성

<u>모델의 추론 능력</u>을 높이기 위함

### 주요 과제

상식/지식 부족, 할루시네이션, 문맥 이해, 논리적 흐름 유지, 텍스트 의미 이해 등

## LLM (Large Language Model)

초기 프롬프트나 문맥을 기반으로 다음 단어 분포를 예측하여 데이터를 생성하기 위해 **autoregression**을 사용함

> 모델 튜닝의 새로운 방법
> 	* Fine-Tuning
> 	* Prompt Engineering
> 	* Feature-Tuning
> 프롬프트 엔지니어링은 다른 두 가지 방식에 비해서 자연어로 명령을 하고, 모델의 결과를 조정하기 때문에 효율적이고, 인적 자원을 절약할 수 있음

## Why Prompt Engineering is Important to AI?

> - **모델 연구**: 언어 모델 성능 극대화, 출력물 제어
> - **서비스 측면**: 기능 구현을 위한 시간 & 자원 절감, 생성형 AI 서비스 사용자 경험 향상

- **목적**
	- 언어 모델 성능 향상을 위한 연구
	- 생성형 AI 서비스

* **효과**
	* `출력 제어`
		* 원하는 결과물을 정확하게 얻기 위해
	* `정확성`
		* 정확하고 관련성 있는 결과를 얻기 위해
	* `편향 완화`
		* 편향을 줄이기 위해
	* `적응성`
		* 각 언어 모델의 최적의 답변을 얻기 위해
	* `문맥 이해`
		* 일관되고 적절한 응답을 유도하기 위해
	* `경제성`
		* 상호작용을 간소화하여 모델 사용비(토큰)를 절감하기 위해
	* `윤리적 사용`
		* 책임 있는 AI를 활용하기 위해 

<hr>

# 프롬프트 요소

- **지시(Instruction)**
	- 모델이 수행할 특정 작업 또는 지시
- **입력 데이터(Input Data)**
	- 응답에 참고 할 입력 값
- **문맥(Context)**
	- 모델이 수행할 특정 작업에 대한 참고 지식이나 배경
- **출력 지시문(Output Indicator)**
	- 응답 형식이나 결과 포맷

```
(Instruction) Sentiment Analysis를 해야해
(Context) 아래 텍스트를 긍정, 중립, 부정 중에서 구분해줘
(Input Data) Text: 그 음식점 마라탕 맛이 그저 그랬어
{Output Indicator} {sentiment}: {부정}
```

![structures of prompt-engineering](images/typeabc.png)

## Type A (지시문 + 출력문)

**Prompt**: 구름 색깔은?

- **지시문**: 구름 색깔은?
- **출력문**: 구름 자체는 색깔을 가지고 있지 않습니다. 구름은 작은 물방울이나 얼음 결정으로 이루어져 있으며, 보통 하얗게 보이는데, 이는 태양 빛이 ... 

## Type B (지시문 + 맥락 + 출력문)

**Prompt**: 해가 질 때 구름 색깔은?

- **지시문**: 구름 색깔은?
- **맥락**: 해가 질 때
- **출력문**: 해가 질 때 구름의 색깔은 주로 빨강, 주황, 분홍색과 같은 따뜻한 톤으로 변합니다. 이 현상은 '레일리 산란'이라고 불리는 광학적 원리 때문입니다.. 

## Type C (지시문 + 맥락 + 예시 + 출력문)

**Prompt**: 
```
해가 질 때 구름 색깔과 종류는? 아래 예시 구조처럼 대답해
#예시
1. 권운: 하얀 섬유 모양의 구름으로 얼음 결정으로 되어 있다.
2. 고적운: 고적운은 중층운으로 양떼구름, 높쌘구름이라고도 한다.
```

- **지시문**: 구름 색깔과 종류는? 아래 예시의 구조처럼 대답해.
- **맥락**: 해가 질 때
- **예시**: 
	- 1) 권운: 하얀 섬유 모양의 구름으로 얼음 결정으로 되어 있다.
	- 2) 고적운: 고적운은 중층운으로 양떼구름, 높쌘구름이라고도 한다.

## Type D (지시문 + 입력값 + 출력문)

**Prompt**:
```
구름의 종류를 설명해줘.
아래 [[입력값]]을 활용해서, 내용을 보충해줘.
한 문단으로 완성해.

[[입력값]]
여러가지 다양한 모양의 구름을 최초로 나눈 사람은 영국의 기상학자 루크하우드 입니다.
그는 1803년, 구름을 네가지 이름으로 구분했습니다.
층운: 넓고, 얇게 펼쳐진 구름
권운: 가느다랗고 새털처럼 생긴 구름
적운: 쌓아 올려진 모양의 구름
난운: 회색빛의 먹구름
지금은 이보다 더 다양한 10개의 기본형으로 나눕니다.
```

> 프롬프트를 어떻게 구성하고, 입력을 하는 지에 따라 결과값이 상이하다.

<hr>

# 프롬프트 설계 방법

## 프롬프트 제작 원칙

- **범용성**
	- 다양한 상황과 과제에 적용 가능성
	- 대상: 불특정 다수의 사용자
	- 예시: 시스템 프롬프트, 문서 요약, 보고서 작성 등
- **일관성**
	- <mark>다양한 언어 모델을 사용하더라도, 여러 번을 생성하더라도, 일정한 품질과 결과를 제공해야 함</mark>
- **목적 지향성**
	- 특정 목적이나 기능을 제공해야 함
	- 대상: 특정 사용자 그룹과 기능
- **경제성**
	- 프롬프트 제작 및 운영비요 효율화 언어 모델 API 사용비 절감

![phase-of-prompt-engineering](images/phaseofpromptwriting.png)

## 프롬프트 설계 팁

### Tip 1. 최신 모델을 사용한다

최신 모델을 사용하면 엉성한 프롬프트를 넣더라도, 좋은 아웃풋이 나올 수 있다.
But, 최신 모델을 사용한다는 것이 항상 좋지만은 않은데, **경제적인 이유** 때문이다.

> GPT 3.5로 GPT 4.x의 성능을 뽑아낼 수 있다면, 저사양 모델을 사용하는 것이 비즈니스 측면에서 유리하다.

### Tip 2. 모델이 해야 할 일을 명확하게 지시한다

명확한 동사를 사용하자

| 효율적인 단어 입력     | 비효율적인 단어 입력 |
| -------------- | ----------- |
| compose 작성해    | write       |
| categorize 분류해 | sort        |
| summarize 요약해  | shorten     |
| organize 정리해   | arrange     |
| list 나열해       | note        |

### Tip 3. 프롬프트를 구조화한다

- 프롬프트 요소 활용
- LLM이 읽기 쉬운 구조

**Structured - Indexing**
- 마크 다운
- 코드 사용

#### 01) Markdown 기호 사용하기

**헤더** (header)
마크다운에서 헤더는 문서를 구조화하고 중요한 섹션을 강조하는 데 사용한다.
제목과 부제목을 만들 수 있다.

```
# 제목: 요리 전문가로 일본식 샤브샤브 만드는 법 알려줘
## 요리 과정: 요리 과정을 최대한 상세하게 알려줘
### 요리 재료: 재료만 나열해줘
```

**목록** (list)
프롬프트 내 정보를 목록 형태로 정리할 때 사용한다.
언어 모델이 수행할 내용을 순차적이거나 카테고리별로 쉽게 이해할 수 있도록 한다.

> 수행할 순서가 있거나, 복잡해서 단계를 거쳐야 할 때 사용하면 좋다.

```
다음 순서를 따라 명령어를 수행해.

1. 첨부된 워드 문서를 확인한다.
2. 문서 내 <테이블 1>을 찾는다.
3. <테이블 1>에서 숫자만을 더한다.
4. 3번의 결과만을 제공해준다.
```

**강조 (emphasis)**
프롬프트의 텍스트의 일부를 굵게하거나, 강조, 기울임꼴로 할 수 있다.

```
**어버이날**에 대한 기사를 읽어.
(https://어버이날 기사 주소)
이 기사의 핵심 포인트를 요약하여 *한 문단* 길이로 생방송 뉴스 스크립트를 작성해줘.
```

#### 2) 파이썬 코드 사용하기 

파이썬 코드를 사용하면, 할루시네이션을 줄일 수 있다는 연구 결과가 있다.

#### 3) XML 태그 사용하기

```
Human: I will tell you the name of an animal. Please respond with the noise that animal makes.
<animal>{{Animal}}</animal>
Assistant:
Please responsed with the noise that animal makes.
<animal>Dog</animal>
```

### Tip 4. 단문 중심의 간결한 문장을 쓰자

한국어라면 '단문' 중심, 촘촘하게 쓰는 것이 좋다.
언어 모델에 작업을 요청할 때 명확하고 구체적인 지시문을 작성하자.
(예시: 원하는 결과물의 톤앤 매너, 형식, 길이, 문단 등)

### Tip 5. '하지 말 것' 보다 '해야 할 것' 을 지시한다

구체적인 내용, 언어 모델이 추측 할 여지가 없도록 하기 

> 프롬프트 제작에 100% 절대적인 것은 없다

<hr>

# LLM의 한계와 프롬프팅의 필요성

- 할루시네이션
- 편향성
- 자료인용 부재
- 수학 & 기초 상식 추론 능력 한계
- 프롬프트 해킹

